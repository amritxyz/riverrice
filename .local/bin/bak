#!/bin/sh

MAIN_DIR="/opt/void"
BAK_DIR="/opt/void/bak"

[ -z "$1" ] && echo "Usage: $0 <directory-name>" && exit 1

[ ! -d "$MAIN_DIR" ] && sudo mkdir -p "$MAIN_DIR" && sudo chown "$USER":"$USER" "$MAIN_DIR"
[ ! -d "$BAK_DIR" ] && sudo mkdir -p "$BAK_DIR" && sudo chown "$USER":"$USER" "$BAK_DIR"

dir="$1"
basename="${dir##*/}"
timestamp="$(date '+%Y-%m-%d_%H-%M-%S')"
archive="$BAK_DIR/${basename}_${timestamp}.tar"

[ ! -d "$dir" ] && echo "Error: '$dir' is not a valid directory." && exit 1

tar -cf "$archive" "$dir" && echo ":: Archive created at: $archive"
